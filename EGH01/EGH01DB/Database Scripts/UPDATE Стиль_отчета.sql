USE [EGH]
GO

INSERT INTO [dbo].[СтильОтчета] VALUES ('Т', '<?xml version="1.0" encoding="utf-8"?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:msxsl="urn:schemas-microsoft-com:xslt" exclude-result-prefixes="msxsl" > <xsl:output method="html" indent="yes"/> <xsl:template match="ECOClassification"> <style> * { font-family:Arial; } h2{ font-weight:bold; text-decoration: underline; text-align:center; font-size:20px; } fieldset{ border:2px black solid; background:#effacf; margin:5px; padding:10px; } .nameOT { border:2px black solid; background:#c8da94; margin:5px; padding:7px; } span{ vertical-align:top; display:inline-block; } .name{ width:48%; padding-right:3%; } .data{ width:48%; } .comment_name{ width:28%; } .comment{ width:68%; } .comment textarea{ width:100%; } .report_name{ text-align:center; font-weight:bold; } </style> <fieldset> <h2> Отчет № <xsl:value-of select="@id"/>-Т- </h2> <p class="report_name"> Выбор технологий реабилитации по результатам последствий разлива нефтепродуктов<br/> (отчет № <xsl:value-of select="ECOEvalution/ECOForecast/@id"/>-П- от <xsl:value-of select="ECOEvalution/ECOForecast/@date"/>) <br/> с предельно допустимыми концентрациями <br/> (отчеты № <xsl:value-of select="ECOEvalution/@id"/>-Р- от <xsl:value-of select="ECOEvalution/@date"/>, <xsl:value-of select="@id"/>-С- от <xsl:value-of select="@date"/>) </p> <p> <span class="name"> </span> <span class="data"> Отчет сформирован <xsl:value-of select="@date"/> </span> </p> <p> <!--Для комментариев--> <span class="comment_name">Комментарий</span> <span class="comment"> <textarea> <xsl:value-of select="@comment"/> </textarea> </span> </p> </fieldset> <fieldset> <h2> Инцидент </h2> <p> <span class="name">Дата инцидента</span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/Incident/@date"/> </span> </p> <p> <span class="name"> Дата сообщения об инциденте </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/Incident/@date_message"/> </span> </p> <p> <span class="name"> Тип инцидента </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/Incident/IncidentType/@name"/> </span> </p> <p> <span class="name"> Тип нефтепродукта </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/PetrochemicalType/@name"/> </span> </p> <p> <span class="name"> Объем пролива (м<sup>3</sup>) </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/@volume"/> </span> </p> <p> Географические координаты </p> <p> <span class="name"> Широта </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/Coordinates/@latitude_d"/>° <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/Coordinates/@latitude_m"/>'' <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/Coordinates/@latitude_s"/>" </span> </p> <p> <span class="name"> Долгота </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/Coordinates/@lngitude_d"/>° <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/Coordinates/@lngitude_m"/>'' <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/Coordinates/@lngitude_s"/>" </span> </p> <!-- <p> <span class="comment_name">Комментарий</span> <span class="comment"> <textarea> <xsl:value-of select="@comment"/> </textarea> </span> </p>--> </fieldset> <fieldset> <h2> Техногенный объект </h2> <p> <span class="name">Дата инцидента</span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/Incident/@date"/> </span> </p> <p> <span class="name"> Наименование </span> <span class="data"> <strong> <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/@name"/> </strong> </span> </p> <!--<div> Дата и время формирования отчета </span><span class="data"><xsl:value-of select="@comment"/> </div> <xsl:apply-templates /> </xsl:template> <xsl:template match="Incident">--> <p> <span class="name"> Адрес </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/@address"/> </span> </p> <p> Географические координаты </p> <p> <span class="name"> Широта </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/Coordinates/@latitude_d"/>° <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/Coordinates/@latitude_m"/>'' <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/Coordinates/@latitude_s"/>" </span> </p> <p> <span class="name"> Долгота </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/Coordinates/@lngitude_d"/>° <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/Coordinates/@lngitude_m"/>'' <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/Coordinates/@lngitude_s"/>" </span> </p> <p> <span class="name"> Категория земель </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/CadastreType/@name"/> </span> </p> <p> <span class="name"> Грунт </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/GroundType/@name"/> </span> </p> <p> <span class="name"> Средняя глубина грунтовых вод (м) </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/@waterdeep"/> </span> </p> <!-- <p> <span class="comment_name">Комментарий</span> <span class="comment"> <textarea> <xsl:value-of select="@comment"/> </textarea> </span> </p>--> </fieldset> <fieldset> <h2> Выбор технологий реабилитации </h2> <p> <span class="name"> Тип объекта </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/RiskObjectType/@name"/> </span> </p> <p> <span class="name"> Категория земель </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/CadastreType/@name"/> </span> </p> <p> <span class="name"> Тип потерянного нефтепродукта </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/PetrochemicalType/PetrochemicalCategories/@name"/> </span> </p> <p> <span class="name"> Масса потерянного нефтепродукта </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/GroundBlur/@adsorbedmass"/>??? </span> </p> <p> <span class="name"> Глубина проникновения загрязнения </span> <span class="data"> ??? </span> </p> <p> <span class="name"> Категория загрязнения почвогрунтов </span> <span class="data"> <xsl:value-of select="SoilPollutionCategories/@name"/> </span> </p> <p> <span class="name"> Достижение горизонта грунтовых вод </span> <span class="data"> <xsl:if test="number(ECOEvalution/ECOForecast/GroundBlur/@restmass)>0">Да</xsl:if> <xsl:if test="not(number(ECOEvalution/ECOForecast/GroundBlur/@restmass)>0)">Нет</xsl:if> </span> </p> <p> <span class="name"> Категория загрязнения грунтовых вод </span> <span class="data"> <xsl:value-of select="WaterPollutionCategories/@name"/> </span> </p> <p> <span class="name"> Водоохранные территории </span> <span class="data"> ??? </span> </p> <fieldset> <h2>Рекомендуемые технологии и технические средства реабилитации геологической среды</h2> <p> <h3> Метод ликвидации загрязнений почвы: </h3> </p> <p> <span class="name"> Описание метода </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/GroundBlur/@restmass"/> </span> </p> <h3> Метод ликвидации загрязнений грунтовых вод: </h3> <span class="data"> </span> <p> <span class="name"> Описание метода </span> <span class="data"> Механический. Экскавация загрязненной части почвогрунтов с последующей утилизацией и/или заменой почвогрунтов </span> </p> </fieldset> </fieldset> <xsl:apply-templates/> </xsl:template></xsl:stylesheet>')
GO

UPDATE [dbo].[СтильОтчета]
   SET [СтильОтчета] = '<?xml version="1.0" encoding="utf-8"?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:msxsl="urn:schemas-microsoft-com:xslt" exclude-result-prefixes="msxsl" > <xsl:output method="html" indent="yes"/> <xsl:template match="ECOForecast"> <style> * { font-family:Arial; } h2{ font-weight:bold; text-decoration: underline; text-align:center; font-size:20px; } fieldset{ border:2px black solid; background:#effacf; margin:5px; padding:10px; } .nameOT { border:2px black solid; background:#c8da94; margin:5px; padding:7px; } span{ vertical-align:top; display:inline-block; } .name{ width:68%; padding-right:3%; } .data{ width:28%; } .comment_name{ width:28%; } .comment{ width:68%; } .comment textarea{ width:100%; } .report_name{ text-align:center; font-weight:bold; } </style> <fieldset> <h2> Отчет № <xsl:value-of select="@id"/>-П- </h2> <p class="report_name"> Результаты прогнозирования последствий пролива нефтепродуктов </p> <p> <span class="name"> Дата и время формирования отчета </span> <span class="data"> <xsl:value-of select="@date"/> </span> <!--Для комментариев--> </p> <p> <span class="comment_name">Комментарий</span> <span class="comment"> <textarea> <xsl:value-of select="@comment"/> </textarea> </span> </p> </fieldset> <xsl:apply-templates /> </xsl:template> <xsl:template match="Incident"> <fieldset> <h2> Инцидент </h2> <p> <span class="name">Дата инцидента</span> <span class="data"> <xsl:value-of select="@date"/> </span> </p> <p> <span class="name"> Дата сообщения об инциденте </span> <span class="data"> <xsl:value-of select="@date_message"/> </span> </p> <p> <span class="name"> Тип инцидента </span> <span class="data"> <xsl:value-of select="IncidentType/@name"/> </span> </p> <p> <span class="name"> Тип нефтепродукта </span> <span class="data"> <xsl:value-of select="SpreadPoint/PetrochemicalType/@name"/> </span> </p> <p> <span class="name"> Объем пролива (м<sup>3</sup>) </span> <span class="data"> <xsl:value-of select="SpreadPoint/@volume"/> </span> </p> <p> Географические координаты </p> <p> <span class="name"> Широта </span> <span class="data"> <xsl:value-of select="SpreadPoint/RiskObject/Point/Coordinates/@latitude_d"/>° <xsl:value-of select="SpreadPoint/RiskObject/Point/Coordinates/@latitude_m"/>'' <xsl:value-of select="SpreadPoint/RiskObject/Point/Coordinates/@latitude_s"/>" </span> </p> <p> <span class="name"> Долгота </span> <span class="data"> <xsl:value-of select="SpreadPoint/RiskObject/Point/Coordinates/@lngitude_d"/>° <xsl:value-of select="SpreadPoint/RiskObject/Point/Coordinates/@lngitude_m"/>'' <xsl:value-of select="SpreadPoint/RiskObject/Point/Coordinates/@lngitude_s"/>" </span> </p> <p> <span class="name"> Адрес </span> <span class="data"> <xsl:value-of select="SpreadPoint/RiskObject/District/@name"/> район, <xsl:value-of select="SpreadPoint/RiskObject/Region/@name"/> область </span> </p> <p> <span class="comment_name">Комментарий</span> <span class="comment"> <textarea> <xsl:value-of select="@comment"/> </textarea> </span> </p> </fieldset> <fieldset> <h2> <xsl:value-of select="SpreadPoint/RiskObject/@name"/> </h2> <!--<div> Дата и время формирования отчета </span><span class="data"><xsl:value-of select="@comment"/> </div> <xsl:apply-templates /> </xsl:template> <xsl:template match="Incident">--> <p> <span class="name"> Регистрационный номер </span> <span class="data"> <xsl:value-of select="SpreadPoint/RiskObject/@id"/> </span> </p> <p> Географические координаты </p> <p> <span class="name"> Широта </span> <span class="data"> <xsl:value-of select="SpreadPoint/RiskObject/Point/Coordinates/@latitude_d"/>° <xsl:value-of select="SpreadPoint/RiskObject/Point/Coordinates/@latitude_m"/>'' <xsl:value-of select="SpreadPoint/RiskObject/Point/Coordinates/@latitude_s"/>" </span> </p> <p> <span class="name"> Долгота </span> <span class="data"> <xsl:value-of select="SpreadPoint/RiskObject/Point/Coordinates/@lngitude_d"/>° <xsl:value-of select="SpreadPoint/RiskObject/Point/Coordinates/@lngitude_m"/>'' <xsl:value-of select="SpreadPoint/RiskObject/Point/Coordinates/@lngitude_s"/>" </span> </p> <p> <span class="name"> Адрес </span> <span class="data"> <xsl:value-of select="SpreadPoint/RiskObject/@address"/>, <xsl:value-of select="SpreadPoint/RiskObject/@ownership"/> </span> </p> <p> <span class="name"> Телефон, факс </span> <span class="data"> <xsl:value-of select="SpreadPoint/RiskObject/@phone"/>, <xsl:value-of select="SpreadPoint/RiskObject/@fax"/> </span> </p> <p> <span class="name"> Дата ввода в эксплуатацию </span> <span class="data"> <xsl:value-of select="SpreadPoint/RiskObject/@foundationdate"/> </span> </p> <!--<p><span class="name"> Количество заправок в сутки </span><span class="data"><xsl:value-of select="SpreadPoint/RiskObject/Region/@"/> </span></p>--> <!--<p><span class="name"> Объем резервуаров (м<sup>3</sup>) </span><span class="data"><xsl:value-of select="SpreadPoint/RiskObject/Region/@foundationdate"/> </span></p>--> <p> <span class="comment_name">Комментарий</span> <span class="comment"> <textarea> <xsl:value-of select="@comment"/> </textarea> </span> </p> </fieldset> <fieldset> <h2> <xsl:value-of select="SpreadPoint/PetrochemicalType/@name"/> </h2> <p> <span class="name"> Температура кипения (°С) </span> <span class="data"> <xsl:value-of select="SpreadPoint/PetrochemicalType/@boilingtemp"/> </span> </p> <!--<p><span class="name"> Температура застывания (°С) </span><span class="data"><xsl:value-of select="SpreadPoint/PetrochemicalType/@ "/> </span></p>--> <p> <span class="name"> Плотность (г/см<sup>3</sup>) </span> <span class="data"> <xsl:value-of select="SpreadPoint/PetrochemicalType/@density"/> </span> </p> <p> <span class="name"> Кинематическая вязкость (мм<sup>2</sup>/дм<sup>3</sup>) </span> <span class="data"> <xsl:value-of select="SpreadPoint/PetrochemicalType/@viscosity"/> </span> </p> <p> <span class="name"> Растворимость (мг/дм<sup>3</sup>) </span> <span class="data"> <xsl:value-of select="SpreadPoint/PetrochemicalType/@solubility"/> </span> </p> <p> <span class="name"> Коэффициент поверхностного натяжения (кг/с<sup>2</sup>) </span> <span class="data"> <xsl:value-of select="SpreadPoint/PetrochemicalType/@tension"/> </span> </p> <p> <span class="name"> Коэффициент дифузии (м<sup>2</sup>/с) </span> <span class="data"> <xsl:value-of select="SpreadPoint/PetrochemicalType/@diffusion"/> </span> </p> </fieldset> </xsl:template> <xsl:template match="ECOForecast/GroundBlur"> <fieldset> <h2> Наземное пятно загрязнения </h2> <p> <span class="name"> Тип нефтепродукта </span> <span class="data"> <xsl:value-of select="SpreadPoint/PetrochemicalType/@name"/> </span> </p> <p> <span class="name"> Объем пролива (м<sup>3</sup>) </span> <span class="data"> <xsl:value-of select="SpreadPoint/@volume"/> </span> </p> <p> Географические координаты </p> <p> <span class="name"> Широта </span> <span class="data"> <xsl:value-of select="SpreadPoint/RiskObject/Point/Coordinates/@latitude_d"/>° <xsl:value-of select="SpreadPoint/RiskObject/Point/Coordinates/@latitude_m"/>'' <xsl:value-of select="SpreadPoint/RiskObject/Point/Coordinates/@latitude_s"/>" </span> </p> <p> <span class="name"> Долгота </span> <span class="data"> <xsl:value-of select="SpreadPoint/RiskObject/Point/Coordinates/@lngitude_d"/>° <xsl:value-of select="SpreadPoint/RiskObject/Point/Coordinates/@lngitude_m"/>'' <xsl:value-of select="SpreadPoint/RiskObject/Point/Coordinates/@lngitude_s"/>" </span> </p> <p> <span class="name"> Грунт в точке пролива </span> <span class="data"> <xsl:value-of select="SpreadPoint/RiskObject/Point/GroundType/@name"/> </span> </p> <!--<p><span class="name"> Коэффициент разлива </span><span class="data"><xsl:value-of select="SpreadPoint/RiskObject/Point/GroundType/@name"/> </span></p>--> <p> <span class="name"> Масса пролива (кг) </span> <span class="data"> <xsl:value-of select="@totalmass"/> </span> </p> <p> <span class="name"> Площадь пролива (м<sup>2</sup>) </span> <span class="data"> <xsl:value-of select="@square"/> </span> </p> <p> <span class="name"> Радиус пролива (м) </span> <span class="data"> <xsl:value-of select="@radius"/> </span> </p> <p> <span class="name"> Максимальная возможная масса адсорбации нефтепродукта грунтами зоны аэрации (кг) </span> <span class="data"> <xsl:value-of select="@limitadsorbedmass"/> </span> </p> <p> <span class="name"> Адсорбированная масса нефтепродукта грунтами зоны аэрации (кг) </span> <span class="data"> <xsl:value-of select="@adsorbedmass"/> </span> </p> <p> <span class="name"> Масса нефтепродукта, достигшая уровня грунтовых вод (кг) </span> <span class="data"> <xsl:value-of select="@restmass"/> </span> </p> <p> <span class="name"> Глубина проникновения нефтепродукта в грунтах зоны аэрации (м) </span> <span class="data"> <xsl:value-of select="@depth"/> </span> </p> <p> <span class="name"> Концентрация нефтепродуктов в грунтах зоны аэрации (кг/кг) </span> <span class="data"> <xsl:value-of select="@concentrationinsoil"/> </span> </p> <p> <span class="name"> Дата достижения грунтовых вод нефтепродуктом </span> <span class="data"> <xsl:value-of select="../@datewatercompletion"/> (<xsl:value-of select="@daywatercomletion"/> сут.) </span> </p> <p> <span class="name"> Дата достижения максимальной концентрации нефтепродукта на уровне грунтовых вод </span> <span class="data"> <xsl:value-of select="../@datemaxwaterconc"/> (<xsl:value-of select="@daymaxwaterconc"/> сут.) </span> </p> <p> <span class="name"> Максимальная концентрация нефтепродукта на уровне грунтовых вод (кг/м<sup>3</sup>) </span> <span class="data"> <xsl:value-of select="@maxconcentrationwater"/> </span> </p> <p> <span class="comment_name">Комментарий</span> <span class="comment"> <textarea> <xsl:value-of select="@comment"/> </textarea> </span> </p> <!--<h3> Опорные точки, попавшие в область загрязнения радиусом <xsl:value-of select="@radius"/> м <xsl:if test="count(GroundPollutionList/GroundPollution[@pointtype=''ANCHOR''])=0">, отсутствуют</xsl:if> </h3> <xsl:for-each select="GroundPollutionList/GroundPollution[@pointtype=''ANCHOR'']"> <fieldset> <p> Географические координаты </p> <p> <span class="name"> Широта </span> <span class="data"> <xsl:value-of select="Point/Coordinates/@latitude_d"/>° <xsl:value-of select="Point/Coordinates/@latitude_m"/>'' <xsl:value-of select="Point/Coordinates/@latitude_s"/>" </span> </p> <p> <span class="name"> Долгота </span> <span class="data"> <xsl:value-of select="Point/Coordinates/@lngitude_d"/>° <xsl:value-of select="Point/Coordinates/@lngitude_m"/>'' <xsl:value-of select="Point/Coordinates/@lngitude_s"/>" </span> </p> <p> <span class="name"> Грунт </span> <span class="data"> <xsl:value-of select="Point/GroundType/@name"/> </span> </p> <p> <span class="name"> Высота над уровнем моря </span> <span class="data"> <xsl:value-of select="Point/@waterdeep"/> </span> </p> <p> <span class="name"> Глубина грунтовых вод (м) </span> <span class="data"> <xsl:value-of select="Point/@height"/> </span> </p> <p> <span class="name"> Расстояние до центра пролива (м) </span> <span class="data"> <xsl:value-of select="@distance"/> </span> </p> <p> <span class="name"> Гидравлический уклон </span> <span class="data"> <xsl:value-of select="@angle"/> </span> </p> <p> <span class="comment_name">Комментарий</span> <span class="comment"> <textarea> <xsl:value-of select="@comment"/> </textarea> </span> </p> </fieldset> </xsl:for-each>--> <h3> Природоохранные объекты, попавшие в область загрязнения радиусом <xsl:value-of select="@radius"/> м <xsl:if test="count(GroundPollutionList/GroundPollution[@pointtype=''ECO''])=0">, отсутствуют</xsl:if> </h3> <xsl:for-each select="GroundPollutionList/GroundPollution[@pointtype=''ECO'']"> <fieldset> <!--<p> <span class="name"> Тип </span> <span class="data"> <xsl:value-of select="EcoObjectType/@name"/> </span> </p>--> <p> <span class="name"> Наименование </span> <span class="data"> <strong> <xsl:value-of select="@name"/> </strong> </span> </p> <p> Географические координаты </p> <p> <span class="name"> Широта </span> <span class="data"> <xsl:value-of select="Point/Coordinates/@latitude_d"/>° <xsl:value-of select="Point/Coordinates/@latitude_m"/>'' <xsl:value-of select="Point/Coordinates/@latitude_s"/>" </span> </p> <p> <span class="name"> Долгота </span> <span class="data"> <xsl:value-of select="Point/Coordinates/@lngitude_d"/>° <xsl:value-of select="Point/Coordinates/@lngitude_m"/>'' <xsl:value-of select="Point/Coordinates/@lngitude_s"/>" </span> </p> <p> <span class="name"> Грунт </span> <span class="data"> <xsl:value-of select="Point/GroundType/@name"/> </span> </p> <p> <span class="name"> Высота над уровнем моря (м) </span> <span class="data"> <xsl:value-of select="Point/@height"/> </span> </p> <p> <span class="name"> Глубина грунтовых вод (м) </span> <span class="data"> <xsl:value-of select="Point/@waterdeep"/> </span> </p> <p> <span class="name"> Расстояние до центра пролива (м) </span> <span class="data"> <xsl:value-of select="@distance"/> </span> </p> <p> <span class="name"> Гидравлический уклон </span> <span class="data"> <xsl:value-of select="@angle"/> </span> </p> <p> <span class="name"> Водоохранный объект </span> <span class="data"> <xsl:value-of select="@iswaterobject"/> </span> </p> <p> <span class="comment_name">Комментарий</span> <span class="comment"> <textarea> <xsl:value-of select="@comment"/> </textarea> </span> </p> </fieldset> </xsl:for-each> </fieldset> </xsl:template> <xsl:template match="ECOForecast/WaterBlur"> <fieldset> <h2> Очаг загрязнения грунтовых вод </h2> <p> <span class="name"> Тип нефтепродукта </span> <span class="data"> <xsl:value-of select="GroundBlur/SpreadPoint/PetrochemicalType/@name"/> </span> </p> <p> <span class="name"> Объем пролива (м<sup>3</sup>) </span> <span class="data"> <xsl:value-of select="GroundBlur/SpreadPoint/@volume"/> </span> </p> <p> Географические координаты </p> <p> <span class="name"> Широта </span> <span class="data"> <xsl:value-of select="GroundBlur/SpreadPoint/RiskObject/Point/Coordinates/@latitude_d"/>° <xsl:value-of select="GroundBlur/SpreadPoint/RiskObject/Point/Coordinates/@latitude_m"/>'' <xsl:value-of select="GroundBlur/SpreadPoint/RiskObject/Point/Coordinates/@latitude_s"/>" </span> </p> <p> <span class="name"> Долгота </span> <span class="data"> <xsl:value-of select="GroundBlur/SpreadPoint/RiskObject/Point/Coordinates/@lngitude_d"/>° <xsl:value-of select="GroundBlur/SpreadPoint/RiskObject/Point/Coordinates/@lngitude_m"/>'' <xsl:value-of select="GroundBlur/SpreadPoint/RiskObject/Point/Coordinates/@lngitude_s"/>" </span> </p> <p> <span class="name"> Масса пролива (кг) </span> <span class="data"> <xsl:value-of select="GroundBlur/@totalmass"/> </span> </p> <p> <span class="name"> Радиус наземного пятна загрязнения (м<sup>2</sup>) </span> <span class="data"> <xsl:value-of select="GroundBlur/@radius"/> </span> </p> <p> <span class="name"> Масса нефтепродукта, достигшая уровня грунтовых вод (кг) </span> <span class="data"> <xsl:value-of select="GroundBlur/@restmass"/> </span> </p> <p> <span class="name"> Дата достижения грунтовых вод нефтепродуктом в радиусе наземного пятна загрязнения </span> <span class="data"> <xsl:value-of select="../@datewatercompletion"/> (<xsl:value-of select="@daywatercomletion"/> сут.) </span> </p> <p> <span class="name"> Дата достижения максимальной концентрации нефтепродукта на уровне грунтовых вод в радиусе наземного пятна </span> <span class="data"> <xsl:value-of select="../@datemaxwaterconc"/> (<xsl:value-of select="@daymaxwaterconc"/> сут.) </span> </p> <p> <span class="name"> Максимальная концентрация нефтепродукта на уровне грунтовых вод в радиусе наземного пятна загрязнения (кг/кг) </span> <span class="data"> <xsl:value-of select="GroundBlur/@maxconcentrationwater"/> </span> </p> <xsl:if test="number(@radius)>0"> <h3> Природоохранные объекты, попавшие в область загрязнения радиусом <xsl:value-of select="GroundBlur/@radius"/>-<xsl:value-of select="@radius"/> м <xsl:if test="count(WaterPollutionList/WaterPollution[@pointtype=''ECO'' and not(@iswaterobject=''да'')])=0">, отсутствуют</xsl:if> </h3> <xsl:for-each select="WaterPollutionList/WaterPollution[@pointtype=''ECO'' and not(@iswaterobject=''да'')]"> <fieldset> <!--<p> <span class="name"> Тип </span> <span class="data"> <xsl:value-of select="EcoObjectType/@name"/> </span> </p>--> <p> <span class="name"> Наименование </span> <span class="data"> <strong> <xsl:value-of select="@name"/> </strong> </span> </p> <p> Географические координаты </p> <p> <span class="name"> Широта </span> <span class="data"> <xsl:value-of select="Point/Coordinates/@latitude_d"/>° <xsl:value-of select="Point/Coordinates/@latitude_m"/>'' <xsl:value-of select="Point/Coordinates/@latitude_s"/>" </span> </p> <p> <span class="name"> Долгота </span> <span class="data"> <xsl:value-of select="Point/Coordinates/@lngitude_d"/>° <xsl:value-of select="Point/Coordinates/@lngitude_m"/>'' <xsl:value-of select="Point/Coordinates/@lngitude_s"/>" </span> </p> <p> <span class="name"> Грунт </span> <span class="data"> <xsl:value-of select="Point/GroundType/@name"/> </span> </p> <p> <span class="name"> Высота над уровнем моря (м) </span> <span class="data"> <xsl:value-of select="Point/@height"/> </span> </p> <p> <span class="name"> Глубина грунтовых вод (м) </span> <span class="data"> <xsl:value-of select="Point/@waterdeep"/> </span> </p> <p> <span class="name"> Расстояние до центра пролива (м) </span> <span class="data"> <xsl:value-of select="@distance"/> </span> </p> <p> <span class="name"> Гидравлический уклон </span> <span class="data"> <xsl:value-of select="@angle"/> </span> </p> <p> <span class="name"> Скорость движения грунтовых вод (м/сут) </span> <span class="data"> <xsl:value-of select="@speedhorizontal"/> </span> </p> <p> <span class="name"> Дата достижения фронтом загрязнения </span> <span class="data"> <xsl:value-of select="@datemaxconcentration"/> (<xsl:value-of select="@daymaxconcentration"/> сут.) </span> </p> <p> <span class="name"> Максимальная концентрация нефтепродукта (кг/м<sup>3</sup>) </span> <span class="data"> <xsl:value-of select="@excessconcentration"/> </span> </p> <p> <span class="comment_name">Комментарий</span> <span class="comment"> <textarea> <xsl:value-of select="@comment"/> </textarea> </span> </p> </fieldset> </xsl:for-each> </xsl:if> <xsl:if test="number(@radius)>0"> <h3> Водоохранные объекты, попавшие в область загрязнения радиусом <xsl:value-of select="GroundBlur/@radius"/>-<xsl:value-of select="@radius"/> м <xsl:if test="count(WaterPollutionList/WaterPollution[@pointtype=''ECO'' and @iswaterobject=''да''])=0">, отсутствуют</xsl:if> </h3> <xsl:for-each select="WaterPollutionList/WaterPollution[@pointtype=''ECO'' and @iswaterobject=''да'']"> <fieldset> <!--<p> <span class="name"> Тип </span> <span class="data"> <xsl:value-of select="EcoObjectType/@name"/> </span> </p>--> <p> <span class="name"> Наименование </span> <span class="data"> <strong> <xsl:value-of select="@name"/> </strong> </span> </p> <p> Географические координаты </p> <p> <span class="name"> Широта </span> <span class="data"> <xsl:value-of select="Point/Coordinates/@latitude_d"/>° <xsl:value-of select="Point/Coordinates/@latitude_m"/>'' <xsl:value-of select="Point/Coordinates/@latitude_s"/>" </span> </p> <p> <span class="name"> Долгота </span> <span class="data"> <xsl:value-of select="Point/Coordinates/@lngitude_d"/>° <xsl:value-of select="Point/Coordinates/@lngitude_m"/>'' <xsl:value-of select="Point/Coordinates/@lngitude_s"/>" </span> </p> <p> <span class="name"> Высота над уровнем моря (м) </span> <span class="data"> <xsl:value-of select="Point/@height"/> </span> </p> <p> <span class="name"> Расстояние до центра пролива (м) </span> <span class="data"> <xsl:value-of select="@distance"/> </span> </p> <p> <span class="name"> Гидравлический уклон </span> <span class="data"> <xsl:value-of select="@angle"/> </span> </p> <p> <span class="name"> Скорость движения грунтовых вод (м/сут) </span> <span class="data"> <xsl:value-of select="@speedhorizontal"/> </span> </p> <p> <span class="name"> Дата достижения фронтом загрязнения </span> <span class="data"> <xsl:value-of select="@datemaxconcentration"/> (<xsl:value-of select="@daymaxconcentration"/> сут.) </span> </p> <p> <span class="name"> Максимальная концентрация нефтепродукта (кг/м<sup>3</sup>) </span> <span class="data"> <xsl:value-of select="@excessconcentration"/> </span> </p> <p> <span class="comment_name">Комментарий</span> <span class="comment"> <textarea> <xsl:value-of select="@comment"/> </textarea> </span> </p> </fieldset> </xsl:for-each> </xsl:if> </fieldset> </xsl:template></xsl:stylesheet>'
 WHERE [Стадия] = 'П'
GO

UPDATE [dbo].[СтильОтчета]
   SET [СтильОтчета] = '<?xml version="1.0" encoding="utf-8"?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:msxsl="urn:schemas-microsoft-com:xslt" exclude-result-prefixes="msxsl" > <xsl:output method="html" indent="yes"/> <xsl:template match="ECOEvalution"> <style> * { font-family:Arial; } h2{ font-weight:bold; text-decoration: underline; text-align:center; font-size:20px; } fieldset{ border:2px black solid; background:#effacf; margin:5px; padding:10px; } .nameOT { border:2px black solid; background:#c8da94; margin:5px; padding:7px; } span{ vertical-align:top; display:inline-block; } .name{ width:48%; padding-right:3%; } .data{ width:48%; } .comment_name{ width:28%; } .comment{ width:68%; } .comment textarea{ width:100%; } .report_name{ text-align:center; font-weight:bold; } </style> <fieldset> <h2> Отчет № <xsl:value-of select="@id"/>-Р- </h2> <p class="report_name"> Сравнение результатов прогнозирования последствий разлива нефтепродуктов <br/>(отчет № <xsl:value-of select="ECOForecast/@id"/>-П- от <xsl:value-of select="ECOForecast/@date"/>) <br/>с предельно допустимыми концентрациями (ПДК) </p> <p> <span class="name"> </span> <span class="data"> Отчет сформирован <xsl:value-of select="@date"/> </span> </p> <p> <!--Для комментариев--> <span class="comment_name">Комментарий</span> <span class="comment"> <textarea> <xsl:value-of select="@comment"/> </textarea> </span> </p> </fieldset> <xsl:apply-templates /> </xsl:template> <xsl:template match="ECOEvalution/ECOForecast/Incident"> <fieldset> <h2> Инцидент </h2> <p> <span class="name">Дата инцидента</span> <span class="data"> <xsl:value-of select="@date"/> </span> </p> <p> <span class="name"> Дата сообщения об инциденте </span> <span class="data"> <xsl:value-of select="@date_message"/> </span> </p> <p> <span class="name"> Тип инцидента </span> <span class="data"> <xsl:value-of select="IncidentType/@name"/> </span> </p> <p> <span class="name"> Тип нефтепродукта </span> <span class="data"> <xsl:value-of select="SpreadPoint/PetrochemicalType/@name"/> </span> </p> <p> <span class="name"> Объем пролива (м<sup>3</sup>) </span> <span class="data"> <xsl:value-of select="SpreadPoint/@volume"/> </span> </p> <p> Географические координаты </p> <p> <span class="name"> Широта </span> <span class="data"> <xsl:value-of select="SpreadPoint/RiskObject/Point/Coordinates/@latitude_d"/>° <xsl:value-of select="SpreadPoint/RiskObject/Point/Coordinates/@latitude_m"/>'' <xsl:value-of select="SpreadPoint/RiskObject/Point/Coordinates/@latitude_s"/>" </span> </p> <p> <span class="name"> Долгота </span> <span class="data"> <xsl:value-of select="SpreadPoint/RiskObject/Point/Coordinates/@lngitude_d"/>° <xsl:value-of select="SpreadPoint/RiskObject/Point/Coordinates/@lngitude_m"/>'' <xsl:value-of select="SpreadPoint/RiskObject/Point/Coordinates/@lngitude_s"/>" </span> </p><!-- <p> <span class="comment_name">Комментарий</span> <span class="comment"> <textarea> <xsl:value-of select="@comment"/> </textarea> </span> </p>--> </fieldset> <fieldset> <h2> Техногенный объект </h2> <p> <span class="name">Дата инцидента</span> <span class="data"> <xsl:value-of select="@date"/> </span> </p> <p> <span class="name"> Наименование </span> <span class="data"> <strong> <xsl:value-of select="SpreadPoint/RiskObject/@name"/> </strong> </span> </p> <!--<div> Дата и время формирования отчета </span><span class="data"><xsl:value-of select="@comment"/> </div> <xsl:apply-templates /> </xsl:template> <xsl:template match="Incident">--> <p> <span class="name"> Адрес </span> <span class="data"> <xsl:value-of select="SpreadPoint/RiskObject/@address"/> </span> </p> <p> Географические координаты </p> <p> <span class="name"> Широта </span> <span class="data"> <xsl:value-of select="SpreadPoint/RiskObject/Point/Coordinates/@latitude_d"/>° <xsl:value-of select="SpreadPoint/RiskObject/Point/Coordinates/@latitude_m"/>'' <xsl:value-of select="SpreadPoint/RiskObject/Point/Coordinates/@latitude_s"/>" </span> </p> <p> <span class="name"> Долгота </span> <span class="data"> <xsl:value-of select="SpreadPoint/RiskObject/Point/Coordinates/@lngitude_d"/>° <xsl:value-of select="SpreadPoint/RiskObject/Point/Coordinates/@lngitude_m"/>'' <xsl:value-of select="SpreadPoint/RiskObject/Point/Coordinates/@lngitude_s"/>" </span> </p> <p> <span class="name"> Категория земель </span> <span class="data"> <xsl:value-of select="SpreadPoint/RiskObject/CadastreType/@name"/> </span> </p> <p> <span class="name"> Грунт </span> <span class="data"> <xsl:value-of select="SpreadPoint/RiskObject/Point/GroundType/@name"/> </span> </p> <p> <span class="name"> Средняя глубина грунтовых вод (м) </span> <span class="data"> <xsl:value-of select="SpreadPoint/RiskObject/Point/@waterdeep"/> </span> </p> <!-- <p> <span class="comment_name">Комментарий</span> <span class="comment"> <textarea> <xsl:value-of select="@comment"/> </textarea> </span> </p>--> </fieldset> </xsl:template> <xsl:template match="ECOEvalution/ECOForecast/GroundBlur"> <fieldset> <h2>Загрязнение грунта зоны аэрации в пятне загрязнения радиусом <xsl:value-of select="@radius"/> м </h2> <p> <span class="name"> Площадь разлива (м<sup>2</sup>) </span> <span class="data"> <xsl:value-of select="@square"/> </span> </p> <p> <span class="name"> Масса пролива (кг) </span> <span class="data"> <xsl:value-of select="@totalmass"/> </span> </p> <p> <span class="name"> Адсорбированная масса нефтепродукта (кг) </span> <span class="data"> <xsl:value-of select="@adsorbedmass"/> </span> </p> <p> <span class="name"> Глубина проникновения нефтепродукта в грунте (м) </span> <span class="data"> <xsl:value-of select="@depth"/> </span> </p> <p> <span class="name"> Масса нефтепродукта, достигшая уровня грунтовых вод (кг) </span> <span class="data"> <xsl:value-of select="@restmass"/> </span> </p> <p> <span class="name"> Дата достижения усредненной концентрации </span> <span class="data"> <xsl:value-of select="../@dateconcentrationinsoil"/> </span> </p> <p> <span class="name"> Средняя концентрация нефтепродукта в грунтах зоны аэрации (кг/кг) </span> <span class="data"> <xsl:value-of select="@concentrationinsoil"/> </span> </p> <p> <span class="name"> ПДК нефтепродукта в грунте (кг/кг) </span> <span class="data"> <xsl:value-of select="SpreadPoint/CadastreType/@pdk_coef"/> (<xsl:value-of select="SpreadPoint/CadastreType/@ground_doc_name"/>) </span> </p> <xsl:if test="not(number(../../@excessgroundconcentration) > 0)"> <p> <span class="name"> Уровень ПДК не превышен </span> <span class="data"> --- </span> </p> </xsl:if> <xsl:if test="number(../../@excessgroundconcentration) > 0"> <p> <span class="name"> Превышение уровня ПДК в грунте </span> <span class="data"> <xsl:value-of select="../../@excessgroundconcentration"/> раз(а) </span> </p> </xsl:if> </fieldset> <fieldset> <h2>Природоохранные объекты, попавшие в область загрязнения радиусом <xsl:value-of select="@radius"/> м <xsl:if test="count(GroundPollutionList/GroundPollution)=0">, отсутствуют</xsl:if> </h2> <xsl:for-each select="GroundPollutionList/GroundPollution"> <!--[@pointtype=''ECO'']--> <fieldset> <!--<p> <span class="name"> Тип </span> <span class="data"> <xsl:value-of select="EcoObjectType/@name"/> </span> </p>--> <p> <span class="name"> Наименование </span> <span class="data"> <strong> <xsl:value-of select="@comment"/> <xsl:value-of select="@name"/> </strong> </span> </p> <p> Географические координаты </p> <p> <span class="name"> Широта </span> <span class="data"> <xsl:value-of select="Point/Coordinates/@latitude_d"/>° <xsl:value-of select="Point/Coordinates/@latitude_m"/>'' <xsl:value-of select="Point/Coordinates/@latitude_s"/>" </span> </p> <p> <span class="name"> Долгота </span> <span class="data"> <xsl:value-of select="Point/Coordinates/@lngitude_d"/>° <xsl:value-of select="Point/Coordinates/@lngitude_m"/>'' <xsl:value-of select="Point/Coordinates/@lngitude_s"/>" </span> </p> <p> <span class="name"> Расстояние до центра пролива (м) </span> <span class="data"> <xsl:value-of select="@distance"/> </span> </p> <p> <span class="name"> Категория земли </span> <span class="data"> <xsl:value-of select="CadastreType/@name"/> </span> </p> <!--<p> <span class="name"> Скорость движения грунтовых вод (м/сут) </span> <span class="data"> <xsl:value-of select="@speedhorizontal"/> </span> </p>--> <!--<hr/> <h3>Загрязнение грунта:</h3> <p> <span class="name"> Время достижения нефтепродуктами объекта </span> <span class="data"> <xsl:value-of select="@daymaxconcentration"/> суток </span> </p> <p> <span class="name"> Максимальная концентрация НП в грунте (кг/кг) </span> <span class="data"> <xsl:if test="not(number(@maxconcentration) > number(CadastreType/@pdk_coef))"> <xsl:value-of select="@maxconcentration"/> </xsl:if> <xsl:if test="number(@maxconcentration) > number(CadastreType/@pdk_coef)"> <span class="red"> <xsl:value-of select="@maxconcentration"/> </span> </xsl:if> </span> </p> <p> <span class="name"> ПДК НП в грунте: </span> <span class="data"> <xsl:value-of select="CadastreType/@pdk_coef"/> кг/кг <xsl:value-of select="CadastreType/@ground_doc_name"/> </span> </p> <xsl:if test="not(number(@maxconcentration) > number(CadastreType/@pdk_coef))"> <p> <span class="name"> Уровень ПДК не превышен </span> <span class="data"> </span> </p> </xsl:if> <xsl:if test="number(@maxconcentration) > number(CadastreType/@pdk_coef)"> <p> <span class="name"> Превышение уровня ПДК </span> <span class="data"> в <xsl:value-of select="round (number(@maxconcentration)*100 div number(CadastreType/@pdk_coef)) div 100"/> раз </span> </p> </xsl:if> <hr/> <h3>Загрязнение грунтовых вод:</h3> <p> <span class="name"> Время достижения нефтепродуктами объекта </span> <span class="data"> <xsl:value-of select="@daymaxconcentration"/> суток </span> </p> <p> <span class="name"> Максимальная концентрация НП в грунтовых водах (кг/м<sup>3</sup>) </span> <span class="data"> <xsl:if test="not(number(@maxconcentration) > number(CadastreType/@water_pdk_coef))"> <xsl:value-of select="@maxconcentration"/> </xsl:if> <xsl:if test="number(@maxconcentration) > number(CadastreType/@water_pdk_coef)"> <span class="red"> <xsl:value-of select="@maxconcentration"/> </span> </xsl:if> </span> </p> <p> <span class="name"> ПДК НП в грунтовых водах: </span> <span class="data"> <xsl:value-of select="CadastreType/@water_pdk_coef"/> кг/кг <xsl:value-of select="CadastreType/@water_doc_name"/> </span> </p> <xsl:if test="not(number(@maxconcentration) > number(CadastreType/@water_pdk_coef))"> <p> <span class="name"> Уровень ПДК не превышен </span> <span class="data"> </span> </p> </xsl:if> <xsl:if test="number(@maxconcentration) > number(CadastreType/@water_pdk_coef)"> <p> <span class="name"> Превышение уровня ПДК </span> <span class="data"> в <xsl:value-of select="@excessconcentration"/> раз(а) </span> </p> </xsl:if> <hr/> <p> <span class="comment_name">Комментарий</span> <span class="comment"> <textarea> <xsl:value-of select="@comment"/> </textarea> </span> </p>--> </fieldset> </xsl:for-each> </fieldset> </xsl:template> <xsl:template match="ECOEvalution/ECOForecast/WaterBlur"> <fieldset> <h2>Загрязнение грунтовых вод в пятне загрязнения радиусом <xsl:value-of select="GroundBlur/@radius"/> м </h2> <p> <span class="name"> Дата достижения уровня грунтовых вод нефтепродуктом </span> <span class="data"> <xsl:value-of select="../@datewatercompletion"/> </span> </p> <p> <span class="name"> Масса нефтепродукта, достигшая уровня грунтовых вод (кг) </span> <span class="data"> <xsl:value-of select="GroundBlur/@restmass"/> </span> </p> <p> <span class="name"> Дата достижения максимальной концентрации </span> <span class="data"> <xsl:value-of select="../@datemaxwaterconc"/> </span> </p> <p> <span class="name"> Максимальная концентрация на уровне грунтовых вод (кг/м<sup>3</sup>) </span> <span class="data"> <xsl:value-of select="GroundBlur/@maxconcentrationwater"/> </span> </p> <p> <span class="name"> ПДК нефтепродукта в грунтовых водах (кг/м<sup>3</sup>) </span> <span class="data"> <xsl:value-of select="GroundBlur/SpreadPoint/CadastreType/@water_pdk_coef"/> (<xsl:value-of select="GroundBlur/SpreadPoint/CadastreType/@water_doc_name"/>) </span> </p> <xsl:if test="not(number(../../@exesswaterconcentration) > 0)"> <p> <span class="name"> Уровень ПДК не превышен </span> <span class="data"> --- </span> </p> </xsl:if> <xsl:if test="number(../../@exesswaterconcentration) > 0"> <p> <span class="name"> Превышение уровня ПДК в грунтовых водах </span> <span class="data"> <xsl:value-of select="../../@exesswaterconcentration"/> раз(а) </span> </p> </xsl:if> </fieldset> <xsl:if test="number(@radius) > 0"> <fieldset> <h2> Природоохранные объекты, попавшие в область загрязнения радиусом <xsl:value-of select="GroundBlur/@radius"/>-<xsl:value-of select="@radius"/> м <xsl:if test="count(WaterPollutionList/WaterPollution)=0">, отсутствуют</xsl:if> </h2> <xsl:for-each select="WaterPollutionList/WaterPollution"> <!--[@pointtype=''ECO'']--> <fieldset> <!--<p> <span class="name"> Тип </span> <span class="data"> <xsl:value-of select="EcoObjectType/@name"/> </span> </p>--> <p> <span class="name"> Наименование </span> <span class="data"> <strong> <xsl:value-of select="@comment"/> <xsl:value-of select="@name"/> </strong> </span> </p> <p> Географические координаты </p> <p> <span class="name"> Широта </span> <span class="data"> <xsl:value-of select="Point/Coordinates/@latitude_d"/>° <xsl:value-of select="Point/Coordinates/@latitude_m"/>'' <xsl:value-of select="Point/Coordinates/@latitude_s"/>" </span> </p> <p> <span class="name"> Долгота </span> <span class="data"> <xsl:value-of select="Point/Coordinates/@lngitude_d"/>° <xsl:value-of select="Point/Coordinates/@lngitude_m"/>'' <xsl:value-of select="Point/Coordinates/@lngitude_s"/>" </span> </p> <p> <span class="name"> Высота над уровнем моря (м) </span> <span class="data"> <xsl:value-of select="Point/@height"/> </span> </p> <p> <span class="name"> Глубина грунтовых вод (м) </span> <span class="data"> <xsl:value-of select="Point/@waterdeep"/> </span> </p> <p> <span class="name"> Расстояние до центра пролива (м) </span> <span class="data"> <xsl:value-of select="@distance"/> </span> </p> <!--<p> <span class="name"> Гидравлический уклон </span> <span class="data"> <xsl:value-of select="@angle"/> </span> </p> <p> <span class="name"> Грунт </span> <span class="data"> <xsl:value-of select="Point/GroundType/@name"/> </span> </p>--> <p> <span class="name"> Категория земли </span> <span class="data"> <xsl:value-of select="CadastreType/@name"/> </span> </p> <!--<p> <span class="name"> Скорость движения грунтовых вод (м/сут) </span> <span class="data"> <xsl:value-of select="@speedhorizontal"/> </span> </p> <h3>Загрязнение грунтовых вод:</h3>--> <p> <span class="name"> Дата достижения максимальной концентрации </span> <span class="data"> <xsl:value-of select="@datemaxconcentration"/> </span> </p> <p> <span class="name"> Максимальная концентрация нефтепродукта (кг/м<sup>3</sup>) </span> <span class="data"> <xsl:if test="not(number(@maxconcentration) > number(CadastreType/@water_pdk_coef))"> <xsl:value-of select="@maxconcentration"/> </xsl:if> <xsl:if test="number(@maxconcentration) > number(CadastreType/@water_pdk_coef)"> <span class="red"> <xsl:value-of select="@maxconcentration"/> </span> </xsl:if> </span> </p> <p> <span class="name"> ПДК нефтепродукта в грунтовых водах (кг/м<sup>3</sup>) </span> <span class="data"> <xsl:value-of select="CadastreType/@water_pdk_coef"/> (<xsl:value-of select="CadastreType/@water_doc_name"/>) </span> </p> <xsl:if test="not(number(@maxconcentration) > number(CadastreType/@water_pdk_coef))"> <p> <span class="name"> Уровень ПДК не превышен </span> <span class="data"> --- </span> </p> </xsl:if> <xsl:if test="number(@maxconcentration) > number(CadastreType/@water_pdk_coef)"> <p> <span class="name"> Превышение уровня ПДК в грунтовых водах </span> <span class="data"> <xsl:value-of select="@excessconcentration"/> раз(а) </span> </p> </xsl:if> </fieldset> </xsl:for-each> </fieldset> </xsl:if> </xsl:template></xsl:stylesheet>'
 WHERE [Стадия] = 'Р'
GO

UPDATE [dbo].[СтильОтчета]
   SET [СтильОтчета] = '<?xml version="1.0" encoding="utf-8"?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:msxsl="urn:schemas-microsoft-com:xslt" exclude-result-prefixes="msxsl" > <xsl:output method="html" indent="yes"/> <xsl:template match="ECOClassification"> <style> * { font-family:Arial; } h2{ font-weight:bold; text-decoration: underline; text-align:center; font-size:20px; } fieldset{ border:2px black solid; background:#effacf; margin:5px; padding:10px; } .nameOT { border:2px black solid; background:#c8da94; margin:5px; padding:7px; } span{ vertical-align:top; display:inline-block; } .name{ width:48%; padding-right:3%; } .data{ width:48%; } .comment_name{ width:28%; } .comment{ width:68%; } .comment textarea{ width:100%; } .report_name{ text-align:center; font-weight:bold; } </style> <fieldset> <h2> Отчет № <xsl:value-of select="@id"/>-С- </h2> <p class="report_name"> Классификация прогнозируемого состояния компонентов геологической среды по результатам прогнозирования последствий разлива нефтепродуктов<br/> (отчет № <xsl:value-of select="ECOEvalution/ECOForecast/@id"/>-П- от <xsl:value-of select="ECOEvalution/ECOForecast/@date"/>) <br/> с предельно допустимыми концентрациями <br/>(отчет № <xsl:value-of select="ECOEvalution/@id"/>-Р- от <xsl:value-of select="ECOEvalution/@date"/>) </p> <p> <span class="name"> </span> <span class="data"> Отчет сформирован <xsl:value-of select="@date"/> </span> </p> <p> <!--Для комментариев--> <span class="comment_name">Комментарий</span> <span class="comment"> <textarea> <xsl:value-of select="@comment"/> </textarea> </span> </p> </fieldset> <fieldset> <h2> Инцидент </h2> <p> <span class="name">Дата инцидента</span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/Incident/@date"/> </span> </p> <p> <span class="name"> Дата сообщения об инциденте </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/Incident/@date_message"/> </span> </p> <p> <span class="name"> Тип инцидента </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/Incident/IncidentType/@name"/> </span> </p> <p> <span class="name"> Тип нефтепродукта </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/PetrochemicalType/@name"/> </span> </p> <p> <span class="name"> Объем пролива (м<sup>3</sup>) </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/@volume"/> </span> </p> <p> Географические координаты </p> <p> <span class="name"> Широта </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/Coordinates/@latitude_d"/>° <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/Coordinates/@latitude_m"/>'' <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/Coordinates/@latitude_s"/>" </span> </p> <p> <span class="name"> Долгота </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/Coordinates/@lngitude_d"/>° <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/Coordinates/@lngitude_m"/>'' <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/Coordinates/@lngitude_s"/>" </span> </p> <!-- <p> <span class="comment_name">Комментарий</span> <span class="comment"> <textarea> <xsl:value-of select="@comment"/> </textarea> </span> </p>--> </fieldset> <fieldset> <h2> Техногенный объект </h2> <p> <span class="name">Дата инцидента</span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/Incident/@date"/> </span> </p> <p> <span class="name"> Наименование </span> <span class="data"> <strong> <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/@name"/> </strong> </span> </p> <!--<div> Дата и время формирования отчета </span><span class="data"><xsl:value-of select="@comment"/> </div> <xsl:apply-templates /> </xsl:template> <xsl:template match="Incident">--> <p> <span class="name"> Адрес </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/@address"/> </span> </p> <p> Географические координаты </p> <p> <span class="name"> Широта </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/Coordinates/@latitude_d"/>° <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/Coordinates/@latitude_m"/>'' <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/Coordinates/@latitude_s"/>" </span> </p> <p> <span class="name"> Долгота </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/Coordinates/@lngitude_d"/>° <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/Coordinates/@lngitude_m"/>'' <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/Coordinates/@lngitude_s"/>" </span> </p> <p> <span class="name"> Категория земель </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/CadastreType/@name"/> </span> </p> <p> <span class="name"> Грунт </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/GroundType/@name"/> </span> </p> <p> <span class="name"> Средняя глубина грунтовых вод (м) </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/@waterdeep"/> </span> </p> <!-- <p> <span class="comment_name">Комментарий</span> <span class="comment"> <textarea> <xsl:value-of select="@comment"/> </textarea> </span> </p>--> </fieldset> <fieldset> <h2> Загрязнение грунта зоны аэрации </h2> <p> <span class="name"> Площадь разлива (м<sup>2</sup>) </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/GroundBlur/@square"/> </span> </p> <p> <span class="name"> Радиус разлива (м) </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/GroundBlur/@radius"/> </span> </p> <p> <span class="name"> Масса пролива (кг) </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/GroundBlur/@totalmass"/> </span> </p> <p> <span class="name"> Адсорбированная масса нефтепродукта (кг) </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/GroundBlur/@adsorbedmass"/> </span> </p> <p> <span class="name"> Глубина проникновения нефтепродукта в грунте (м) </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/GroundBlur/@depth"/> </span> </p> <p> <span class="name"> Масса нефтепродукта, достигшая уровня грунтовых вод (кг) </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/GroundBlur/@restmass"/> </span> </p> <p> <span class="name"> Дата достижения усредненной концентрации </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/@dateconcentrationinsoil"/> </span> </p> <p> <span class="name"> Средняя концентрация нефтепродукта в грунтах зоны аэрации (кг/кг) </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/GroundBlur/@concentrationinsoil"/> </span> </p> <p> <span class="name"> ПДК нефтепродукта в грунте (кг/кг) </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/GroundBlur/SpreadPoint/CadastreType/@pdk_coef"/> (<xsl:value-of select="ECOEvalution/ECOForecast/GroundBlur/SpreadPoint/CadastreType/@ground_doc_name"/>) </span> </p> <xsl:if test="not(number(ECOEvalution/@excessgroundconcentration) > 0)"> <p> <span class="name"> Уровень ПДК не превышен </span> <span class="data"> --- </span> </p> </xsl:if> <xsl:if test="number(ECOEvalution/@excessgroundconcentration) > 0"> <p> <span class="name"> Превышение уровня ПДК в грунте </span> <span class="data"> <xsl:value-of select="ECOEvalution/@excessgroundconcentration"/> раз(а) </span> </p> </xsl:if> <p> <span class="name"> Категория загрязнения почв </span> <span class="data"> <xsl:value-of select="SoilPollutionCategories/@name"/> </span> </p> </fieldset> <fieldset> <h2>Загрязнение грунтовых вод</h2> <p> <span class="name"> Дата достижения уровня грунтовых вод нефтепродуктом </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/@datewatercompletion"/> </span> </p> <p> <span class="name"> Масса нефтепродукта, достигшая уровня грунтовых вод (кг) </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/GroundBlur/@restmass"/> </span> </p> <p> <span class="name"> Дата достижения максимальной концентрации </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/@datemaxwaterconc"/> </span> </p> <p> <span class="name"> Максимальная концентрация на уровне грунтовых вод (кг/м<sup>3</sup>) </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/GroundBlur/@maxconcentrationwater"/> </span> </p> <p> <span class="name"> ПДК нефтепродукта в грунтовых водах (кг/м<sup>3</sup>) </span> <span class="data"> <xsl:value-of select="ECOEvalution/ECOForecast/GroundBlur/SpreadPoint/CadastreType/@water_pdk_coef"/> (<xsl:value-of select="ECOEvalution/ECOForecast/GroundBlur/SpreadPoint/CadastreType/@water_doc_name"/>) </span> </p> <xsl:if test="not(number(ECOEvalution/@exesswaterconcentration) > 0)"> <p> <span class="name"> Уровень ПДК не превышен </span> <span class="data"> --- </span> </p> </xsl:if> <xsl:if test="number(ECOEvalution/@exesswaterconcentration) > 0"> <p> <span class="name"> Превышение уровня ПДК в грунтовых водах </span> <span class="data"> <xsl:value-of select="ECOEvalution/@exesswaterconcentration"/> раз(а) </span> </p> <p> <span class="name"> Категория загрязнения грунтовых вод </span> <span class="data"> <xsl:value-of select="WaterPollutionCategories/@name"/> </span> </p> </xsl:if> </fieldset> <xsl:apply-templates /> </xsl:template> <xsl:template match="ECOClassification/ECOEvalution/ECOForecast/WaterBlur"> <fieldset> <h2> Природоохранные объекты, попавшие в область загрязнения радиусом <xsl:value-of select="@radius"/> м <xsl:if test="count(WaterPollutionList/WaterPollution)=0">, отсутствуют</xsl:if> </h2> <xsl:for-each select="WaterPollutionList/WaterPollution"> <!--[@pointtype=''ECO'']--> <fieldset> <!--<p> <span class="name"> Тип </span> <span class="data"> <xsl:value-of select="EcoObjectType/@name"/> </span> </p>--> <p> <span class="name"> Наименование </span> <span class="data"> <strong> <xsl:value-of select="@comment"/> <xsl:value-of select="@name"/> </strong> </span> </p> <p> Географические координаты </p> <p> <span class="name"> Широта </span> <span class="data"> <xsl:value-of select="Point/Coordinates/@latitude_d"/>° <xsl:value-of select="Point/Coordinates/@latitude_m"/>'' <xsl:value-of select="Point/Coordinates/@latitude_s"/>" </span> </p> <p> <span class="name"> Долгота </span> <span class="data"> <xsl:value-of select="Point/Coordinates/@lngitude_d"/>° <xsl:value-of select="Point/Coordinates/@lngitude_m"/>'' <xsl:value-of select="Point/Coordinates/@lngitude_s"/>" </span> </p> <p> <span class="name"> Высота над уровнем моря (м) </span> <span class="data"> <xsl:value-of select="Point/@height"/> </span> </p> <p> <span class="name"> Глубина грунтовых вод (м) </span> <span class="data"> <xsl:value-of select="Point/@waterdeep"/> </span> </p> <p> <span class="name"> Расстояние до центра пролива (м) </span> <span class="data"> <xsl:value-of select="@distance"/> </span> </p> <p> <span class="name"> Категория земли </span> <span class="data"> <xsl:value-of select="CadastreType/@name"/> </span> </p> <!--<p> <span class="name"> Скорость движения грунтовых вод (м/сут) </span> <span class="data"> <xsl:value-of select="@speedhorizontal"/> </span> </p> <h3>Загрязнение грунтовых вод:</h3>--> <p> <span class="name"> Дата достижения максимальной концентрации </span> <span class="data"> <xsl:value-of select="@datemaxconcentration"/> </span> </p> <p> <span class="name"> Максимальная концентрация нефтепродукта (кг/м<sup>3</sup>) </span> <span class="data"> <xsl:if test="not(number(@maxconcentration) > number(CadastreType/@water_pdk_coef))"> <xsl:value-of select="@maxconcentration"/> </xsl:if> <xsl:if test="number(@maxconcentration) > number(CadastreType/@water_pdk_coef)"> <span class="red"> <xsl:value-of select="@maxconcentration"/> </span> </xsl:if> </span> </p> <p> <span class="name"> ПДК нефтепродукта в грунтовых водах (кг/м<sup>3</sup>) </span> <span class="data"> <xsl:value-of select="CadastreType/@water_pdk_coef"/> (<xsl:value-of select="CadastreType/@water_doc_name"/>) </span> </p> <xsl:if test="not(number(@maxconcentration) > number(CadastreType/@water_pdk_coef))"> <p> <span class="name"> Уровень ПДК не превышен </span> <span class="data"> --- </span> </p> </xsl:if> <xsl:if test="number(@maxconcentration) > number(CadastreType/@water_pdk_coef)"> <p> <span class="name"> Превышение уровня ПДК в грунтовых водах </span> <span class="data"> <xsl:value-of select="@excessconcentration"/> раз(а) </span> </p> </xsl:if> <p> <span class="name"> Категория загрязнения грунтовых вод </span> <span class="data"> <xsl:value-of select="WaterPollutionCategories/@name"/> </span> </p> </fieldset> </xsl:for-each> </fieldset> <xsl:apply-templates/> </xsl:template></xsl:stylesheet>'
 WHERE [Стадия] = 'С'
GO

UPDATE [dbo].[СтильОтчета]
   SET [СтильОтчета] = '<?xml version="1.0" encoding="utf-8"?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:msxsl="urn:schemas-microsoft-com:xslt" exclude-result-prefixes="msxsl" > <xsl:output method="html" indent="yes"/> <xsl:template match="ECORehabilitation"> <style> * { font-family:Arial; } h2{ font-weight:bold; text-decoration: underline; text-align:center; font-size:20px; } fieldset{ border:2px black solid; background:#effacf; margin:5px; padding:10px; } .nameOT { border:2px black solid; background:#c8da94; margin:5px; padding:7px; } span{ vertical-align:top; display:inline-block; } .name{ width:48%; padding-right:3%; } .data{ width:48%; } .comment_name{ width:28%; } .comment{ width:68%; } .comment textarea{ width:100%; } .report_name{ text-align:center; font-weight:bold; } </style> <fieldset> <h2> Отчет № <xsl:value-of select="@id"/>-Т- </h2> <p class="report_name"> Выбор технологий реабилитации по результатам последствий разлива нефтепродуктов<br/> (отчет № <xsl:value-of select="ECOClassification/ECOEvalution/ECOForecast/@id"/>-П- от <xsl:value-of select="ECOClassification/ECOEvalution/ECOForecast/@date"/>) <br/> с предельно допустимыми концентрациями <br/> (отчеты № <xsl:value-of select="ECOClassification/ECOEvalution/@id"/>-Р- от <xsl:value-of select="ECOClassification/ECOEvalution/@date"/>, <xsl:value-of select="ECOClassification/@id"/>-С- от <xsl:value-of select="@date"/>) </p> <p> <span class="name"> </span> <span class="data"> Отчет сформирован <xsl:value-of select="@date"/> </span> </p> </fieldset> <fieldset> <h2> Инцидент </h2> <p> <span class="name">Дата инцидента</span> <span class="data"> <xsl:value-of select="ECOClassification/ECOEvalution/ECOForecast/Incident/@date"/> </span> </p> <p> <span class="name"> Дата сообщения об инциденте </span> <span class="data"> <xsl:value-of select="ECOClassification/ECOEvalution/ECOForecast/Incident/@date_message"/> </span> </p> <p> <span class="name"> Тип инцидента </span> <span class="data"> <xsl:value-of select="ECOClassification/ECOEvalution/ECOForecast/Incident/IncidentType/@name"/> </span> </p> <p> <span class="name"> Тип нефтепродукта </span> <span class="data"> <xsl:value-of select="ECOClassification/ECOEvalution/ECOForecast/Incident/SpreadPoint/PetrochemicalType/@name"/> </span> </p> <p> <span class="name"> Объем пролива (м<sup>3</sup>) </span> <span class="data"> <xsl:value-of select="ECOClassification/ECOEvalution/ECOForecast/Incident/SpreadPoint/@volume"/> </span> </p> <p> Географические координаты </p> <p> <span class="name"> Широта </span> <span class="data"> <xsl:value-of select="ECOClassification/ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/Coordinates/@latitude_d"/>° <xsl:value-of select="ECOClassification/ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/Coordinates/@latitude_m"/>'' <xsl:value-of select="ECOClassification/ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/Coordinates/@latitude_s"/>" </span> </p> <p> <span class="name"> Долгота </span> <span class="data"> <xsl:value-of select="ECOClassification/ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/Coordinates/@lngitude_d"/>° <xsl:value-of select="ECOClassification/ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/Coordinates/@lngitude_m"/>'' <xsl:value-of select="ECOClassification/ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/Coordinates/@lngitude_s"/>" </span> </p> <!-- <p> <span class="comment_name">Комментарий</span> <span class="comment"> <textarea> <xsl:value-of select="@comment"/> </textarea> </span> </p>--> </fieldset> <fieldset> <h2> Техногенный объект </h2> <p> <span class="name">Дата инцидента</span> <span class="data"> <xsl:value-of select="ECOClassification/ECOEvalution/ECOForecast/Incident/@date"/> </span> </p> <p> <span class="name"> Наименование </span> <span class="data"> <strong> <xsl:value-of select="ECOClassification/ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/@name"/> </strong> </span> </p> <p> <span class="name"> Адрес </span> <span class="data"> <xsl:value-of select="ECOClassification/ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/@address"/> </span> </p> <p> Географические координаты </p> <p> <span class="name"> Широта </span> <span class="data"> <xsl:value-of select="ECOClassification/ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/Coordinates/@latitude_d"/>° <xsl:value-of select="ECOClassification/ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/Coordinates/@latitude_m"/>'' <xsl:value-of select="ECOClassification/ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/Coordinates/@latitude_s"/>" </span> </p> <p> <span class="name"> Долгота </span> <span class="data"> <xsl:value-of select="ECOClassification/ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/Coordinates/@lngitude_d"/>° <xsl:value-of select="ECOClassification/ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/Coordinates/@lngitude_m"/>'' <xsl:value-of select="ECOClassification/ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/Coordinates/@lngitude_s"/>" </span> </p> <p> <span class="name"> Категория земель </span> <span class="data"> <xsl:value-of select="ECOClassification/ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/CadastreType/@name"/> </span> </p> <p> <span class="name"> Грунт </span> <span class="data"> <xsl:value-of select="ECOClassification/ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/GroundType/@name"/> </span> </p> <p> <span class="name"> Средняя глубина грунтовых вод (м) </span> <span class="data"> <xsl:value-of select="ECOClassification/ECOEvalution/ECOForecast/Incident/SpreadPoint/RiskObject/Point/@waterdeep"/> </span> </p> <!-- <p> <span class="comment_name">Комментарий</span> <span class="comment"> <textarea> <xsl:value-of select="@comment"/> </textarea> </span> </p>--> </fieldset> <fieldset> <h2> Природоохранные объекты, попавшие в область загрязнения радиусом <xsl:value-of select="ECOClassification/ECOEvalution/ECOForecast/WaterBlur/@radius"/> м <xsl:if test="count(ECOClassification/ECOEvalution/ECOForecast/WaterBlur/WaterPollutionList/WaterPollution)=0">, отсутствуют</xsl:if> </h2> <xsl:for-each select="ECOClassification/ECOEvalution/ECOForecast/WaterBlur/WaterPollutionList/WaterPollution"> <!--[@pointtype=''ECO'']--> <fieldset> <!--<p> <span class="name"> Тип </span> <span class="data"> <xsl:value-of select="EcoObjectType/@name"/> </span> </p>--> <p> <span class="name"> Наименование </span> <span class="data"> <strong> <xsl:value-of select="@comment"/> <xsl:value-of select="@name"/> </strong> </span> </p> <p> Географические координаты </p> <p> <span class="name"> Широта </span> <span class="data"> <xsl:value-of select="Point/Coordinates/@latitude_d"/>° <xsl:value-of select="Point/Coordinates/@latitude_m"/>'' <xsl:value-of select="Point/Coordinates/@latitude_s"/>" </span> </p> <p> <span class="name"> Долгота </span> <span class="data"> <xsl:value-of select="Point/Coordinates/@lngitude_d"/>° <xsl:value-of select="Point/Coordinates/@lngitude_m"/>'' <xsl:value-of select="Point/Coordinates/@lngitude_s"/>" </span> </p> <p> <span class="name"> Высота над уровнем моря (м) </span> <span class="data"> <xsl:value-of select="Point/@height"/> </span> </p> <p> <span class="name"> Глубина грунтовых вод (м) </span> <span class="data"> <xsl:value-of select="Point/@waterdeep"/> </span> </p> <p> <span class="name"> Расстояние до центра пролива (м) </span> <span class="data"> <xsl:value-of select="@distance"/> </span> </p> <p> <span class="name"> Категория земли </span> <span class="data"> <xsl:value-of select="CadastreType/@name"/> </span> </p> <!--<p> <span class="name"> Скорость движения грунтовых вод (м/сут) </span> <span class="data"> <xsl:value-of select="@speedhorizontal"/> </span> </p> <h3>Загрязнение грунтовых вод:</h3>--> <p> <span class="name"> Дата достижения максимальной концентрации </span> <span class="data"> <xsl:value-of select="@datemaxconcentration"/> </span> </p> <p> <span class="name"> Максимальная концентрация нефтепродукта (кг/м<sup>3</sup>) </span> <span class="data"> <xsl:if test="not(number(@maxconcentration) > number(CadastreType/@water_pdk_coef))"> <xsl:value-of select="@maxconcentration"/> </xsl:if> <xsl:if test="number(@maxconcentration) > number(CadastreType/@water_pdk_coef)"> <span class="red"> <xsl:value-of select="@maxconcentration"/> </span> </xsl:if> </span> </p> <p> <span class="name"> ПДК нефтепродукта в грунтовых водах (кг/м<sup>3</sup>) </span> <span class="data"> <xsl:value-of select="CadastreType/@water_pdk_coef"/> (<xsl:value-of select="CadastreType/@water_doc_name"/>) </span> </p> <xsl:if test="not(number(@maxconcentration) > number(CadastreType/@water_pdk_coef))"> <p> <span class="name"> Уровень ПДК не превышен </span> <span class="data"> --- </span> </p> </xsl:if> <xsl:if test="number(@maxconcentration) > number(CadastreType/@water_pdk_coef)"> <p> <span class="name"> Превышение уровня ПДК в грунтовых водах </span> <span class="data"> <xsl:value-of select="@excessconcentration"/> раз(а) </span> </p> </xsl:if> <p> <span class="name"> Категория загрязнения грунтовых вод </span> <span class="data"> <xsl:value-of select="WaterPollutionCategories/@name"/> </span> </p> </fieldset> </xsl:for-each> </fieldset> <fieldset> <h2> Выбор технологий реабилитации </h2> <p> <span class="name"> Тип объекта </span> <span class="data"> <xsl:value-of select="RiskObjectType/@name"/> </span> </p> <p> <span class="name"> Категория земель </span> <span class="data"> <xsl:value-of select="CadastreType/@name"/> </span> </p> <p> <span class="name"> Тип потерянного нефтепродукта </span> <span class="data"> <xsl:value-of select="PetrochemicalCategories/@name"/> </span> </p> <p> <span class="name"> Масса потерянного нефтепродукта </span> <span class="data"> <xsl:value-of select="EmergencyClass/@name"/> </span> </p> <p> <span class="name"> Глубина проникновения загрязнения </span> <span class="data"> <xsl:value-of select="PenetrationDepth/@name"/> </span> </p> <p> <span class="name"> Категория загрязнения почвогрунтов </span> <span class="data"> <xsl:value-of select="SoilPollutionCategories/@name"/> </span> </p> <p> <span class="name"> Достижение горизонта грунтовых вод </span> <span class="data"> <xsl:value-of select="@waterachieved"/> </span> </p> <p> <span class="name"> Категория загрязнения грунтовых вод </span> <span class="data"> <xsl:value-of select="WaterPollutionCategories/@name"/> </span> </p> <p> <span class="name"> Водоохранные территории </span> <span class="data"> <xsl:value-of select="WaterProtectionArea/@name"/> </span> </p> <fieldset> <h2>Рекомендуемые технологии и технические средства реабилитации геологической среды <xsl:if test="count(RehabilitationMethodList/RehabilitationMethod)=0"> отсутствуют</xsl:if></h2> <xsl:for-each select="RehabilitationMethodList/RehabilitationMethod"> <fieldset> <p> <strong> Метод ликвидации загрязнений почвы: </strong> </p> <p> <span class="comment_name"> Описание метода </span> <span class="comment"> <xsl:value-of select="SoilCleaningMethod/@method_description"/> </span> </p> <p> <strong> Метод ликвидации загрязнений грунтовых вод: </strong> </p> <p> <span class="comment_name"> Описание метода </span> <span class="comment"> <xsl:value-of select="WaterCleaningMethod/@method_description"/> </span> </p> </fieldset> </xsl:for-each> </fieldset> </fieldset> </xsl:template></xsl:stylesheet>'
 WHERE [Стадия] = 'Т'
GO
